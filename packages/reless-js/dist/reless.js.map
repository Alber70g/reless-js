{"version":3,"file":"reless.js","sources":["../src/index.js"],"sourcesContent":["export default class Reless {\n  constructor(initializer) {\n    initializer = initializer || {}\n    this.appState = { ...initializer.state }\n    let reducers = { ...initializer.reducers }\n    let events = { ...initializer.events }\n    this.events = events\n    // Wrap all reducers so they can be called directly\n    this.reducers = Object.keys(reducers).reduce((acc, name) => {\n      const reducer = reducers[name]\n      // wrap the reducer in a function accepting the payload\n      acc[name] = payload => {\n        // reducer to use for __REDUX_DEVTOOLS_EXTENSION__\n        if (events.reducer) events.reducer(this.state, name)\n        if (typeof payload === 'function') {\n          payload = payload(this.state)\n        }\n        // call the reducer with the payload\n        let withState = reducer(payload)\n        // define withReducers and fromWithReducers to be able to _merge lateron\n        let withReducers = null\n        let fromWithReducers = null\n        if (typeof withState === 'function') {\n          // the reducer returned another function (withStateFn),\n          // call withStateFn with the state\n          withReducers = withState(this.appState)\n          if (typeof withReducers === 'function') {\n            // the withStateFn returned a function (withReducersFn)\n            // call withReducersFn with the reducers\n            fromWithReducers = withReducers(this.reducers)\n          }\n        }\n        // _merge the result of either function with the current state\n        this.appState = this._merge(\n          this.appState,\n          fromWithReducers || withReducers || withState,\n        )\n        if (events.newState) events.newState(this.state)\n      }\n      return acc\n    }, {})\n  }\n\n  get state() {\n    return Object.freeze({ ...this.appState })\n  }\n\n  _merge(a, b) {\n    for (var i in b) {\n      a[i] = b[i]\n    }\n    return a\n  }\n}\n"],"names":["Reless","initializer","appState","state","reducers","events","Object","keys","reduce","acc","name","reducer","payload","withState","withReducers","fromWithReducers","_merge","newState","a","b","i","freeze"],"mappings":";;;;;;;;;;;;IAAqBA;kBACPC,WAAZ,EAAyB;;;;;kBACTA,eAAe,EAA7B;SACKC,QAAL,gBAAqBD,YAAYE,KAAjC;QACIC,wBAAgBH,YAAYG,QAA5B,CAAJ;QACIC,sBAAcJ,YAAYI,MAA1B,CAAJ;SACKA,MAAL,GAAcA,MAAd;;SAEKD,QAAL,GAAgBE,OAAOC,IAAP,CAAYH,QAAZ,EAAsBI,MAAtB,CAA6B,UAACC,GAAD,EAAMC,IAAN,EAAe;UACpDC,UAAUP,SAASM,IAAT,CAAhB;;UAEIA,IAAJ,IAAY,mBAAW;;YAEjBL,OAAOM,OAAX,EAAoBN,OAAOM,OAAP,CAAe,MAAKR,KAApB,EAA2BO,IAA3B;YAChB,OAAOE,OAAP,KAAmB,UAAvB,EAAmC;oBACvBA,QAAQ,MAAKT,KAAb,CAAV;;;YAGEU,YAAYF,QAAQC,OAAR,CAAhB;;YAEIE,eAAe,IAAnB;YACIC,mBAAmB,IAAvB;YACI,OAAOF,SAAP,KAAqB,UAAzB,EAAqC;;;yBAGpBA,UAAU,MAAKX,QAAf,CAAf;cACI,OAAOY,YAAP,KAAwB,UAA5B,EAAwC;;;+BAGnBA,aAAa,MAAKV,QAAlB,CAAnB;;;;cAICF,QAAL,GAAgB,MAAKc,MAAL,CACd,MAAKd,QADS,EAEda,oBAAoBD,YAApB,IAAoCD,SAFtB,CAAhB;YAIIR,OAAOY,QAAX,EAAqBZ,OAAOY,QAAP,CAAgB,MAAKd,KAArB;OA1BvB;aA4BOM,GAAP;KA/Bc,EAgCb,EAhCa,CAAhB;;;;;2BAuCKS,GAAGC,GAAG;WACN,IAAIC,CAAT,IAAcD,CAAd,EAAiB;UACbC,CAAF,IAAOD,EAAEC,CAAF,CAAP;;aAEKF,CAAP;;;;wBARU;aACHZ,OAAOe,MAAP,cAAmB,KAAKnB,QAAxB,EAAP;;;;;;;;;;;;;"}